-- ===============================!===============!===================!========
-- Result Tables (Trade)
-- ===============================!===============!===================!========
CREATE TABLE r_trade (
  acted_as                        STRING,
  acted_capacity                  STRING,
  ask_price                       NUMBER(15,6),
  as_of                           STRING,
  bid_price                       NUMBER(15,6),
  contra_broker                   STRING,
  cust_branch                     STRING,
  exchange                        STRING,
  executing_broker                STRING,
  execution_reason                INT,
  execution_venue                 STRING,
  firm                            STRING,
  has_riskless                    STRING,
  iso_num                         STRING,
  leaves_qty                      INT,
  oms_date                        DATE,
  oms_date_time                   TIMESTAMP_NTZ,
  on_open_or_close                STRING,
  order_system                    STRING,
  price                           NUMBER(15,6),
  process_type                    STRING,
  quantity                        INT,
  record_seq_num                  INT,
  route_type                      STRING,
  rule_count                      INT,
  rules                           STRING,
  rule_sets                       STRING,
  score                           INT,
  security_type                   STRING,
  short_name                      STRING,
  side                            STRING,
  side_status                     STRING,
  submit_date                     TIMESTAMP_NTZ,
  sub_short_name                  STRING,
  symbol                          STRING,
  trade_modifier                  STRING,
  trader                          STRING,
  trade_ref_num                   STRING,
  trade_report                    STRING,
  trade_thru                      STRING,
  trade_thru_reason               STRING,
  trans_date                      DATE,
  trans_date_time                 TIMESTAMP_NTZ,
  trans_type                      STRING,
  unit_key                        STRING,
  cust_info                       STRING,
  ss_exempt_reason                STRING,
  ss_restriction                  STRING,
  act_ref_num                     STRING,
  order_id                        STRING,
  order_ref_num                   STRING,
  trade_id                        STRING,
  desk                            STRING,
  isin                            STRING,
  result_key                      BIGINT NOT NULL,
  underlying_symbol               STRING,
  tick_pilot_flag                 STRING,
  tick_size_group                 STRING,
  oms_user                        STRING,
  PRIMARY KEY (result_key)
);

CREATE TABLE r_trade_detail (
  profile                         STRING NOT NULL,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (result_key),
  FOREIGN KEY (result_key) REFERENCES r_trade(result_key)
);

CREATE TABLE r_trade_reason (
  row_key                         BIGINT IDENTITY(1,1) NOT NULL,
  create_date                     DATE DEFAULT CURRENT_DATE() NOT NULL,
  create_date_time                TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP() NOT NULL,
  audit_id                        STRING,
  impact                          INT,
  rule_id                         INT,
  ruleset_id                      INT,
  common_text                     STRING,
  main_text                       STRING,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (row_key),
  FOREIGN KEY (result_key) REFERENCES r_trade(result_key)
);

CREATE TABLE r_trade_status (
  row_key                         BIGINT IDENTITY(1,1) NOT NULL,
  create_date                     DATE DEFAULT CURRENT_DATE() NOT NULL,
  create_date_time                TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP() NOT NULL,
  rule_id                         INT,
  comments                        STRING,
  review_status                   INT,
  update_date                     TIMESTAMP_NTZ,
  update_user                     STRING,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (row_key),
  FOREIGN KEY (result_key) REFERENCES r_trade(result_key)
);

---------------------

-- ===============================!===============!===================!========
-- Result Tables (Order)
-- ===============================!===============!===================!========
CREATE TABLE r_order (
  acted_as                        STRING,
  all_or_none                     STRING,
  ask_price                       NUMBER(15,6),
  bid_price                       NUMBER(15,6),
  contra_broker                   STRING,
  cust_acct_num                   STRING,
  cust_branch                     STRING,
  exchange                        STRING,
  executed_qty                    INT,
  firm                            STRING,
  limit_price                     NUMBER(15,6),
  market_maker                    STRING,
  not_held                        STRING,
  oms_date                        DATE,
  oms_date_time                   TIMESTAMP_NTZ,
  oms_user                        STRING,
  on_open_or_close                STRING,
  order_system                    STRING,
  order_type                      STRING,
  process_type                    STRING,
  quantity                        INT,
  record_seq_num                  INT,
  rule_count                      INT,
  rules                           STRING,
  rule_sets                       STRING,
  score                           INT,
  security_type                   STRING,
  short_name                      STRING,
  side                            STRING,
  side_status                     STRING,
  submit_date                     TIMESTAMP_NTZ,
  sub_short_name                  STRING,
  symbol                          STRING,
  time_in_force                   STRING,
  trade_along                     STRING,
  trader                          STRING,
  trans_type                      STRING,
  unit_key                        STRING,
  cust_info                       STRING,
  ss_exempt_reason                STRING,
  ss_restriction                  STRING,
  order_id                        STRING,
  order_ref_num                   STRING,
  locate_info                     STRING,
  desk                            STRING,
  cust_or_firm                    STRING,
  maturity_date                   DATE,
  open_or_close                   STRING,
  put_or_call                     STRING,
  strike_price                    NUMBER(15,6),
  contract_multiplier             NUMBER(15,6),
  leg_ratio_qty                   NUMBER(15,6),
  underlying_symbol               STRING,
  source_oms                      STRING,
  flag_asset                      STRING,
  isin                            STRING,
  leg_num                         STRING,
  result_key                      BIGINT NOT NULL,
  tick_pilot_flag                 STRING,
  tick_size_group                 STRING,
  instructions                    STRING,
  PRIMARY KEY (result_key)
);

CREATE TABLE r_order_detail (
  profile                         STRING NOT NULL,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (result_key),
  FOREIGN KEY (result_key) REFERENCES r_order(result_key)
);

CREATE TABLE r_order_reason (
  row_key                         BIGINT IDENTITY(1,1) NOT NULL,
  create_date                     DATE DEFAULT CURRENT_DATE() NOT NULL,
  create_date_time                TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP() NOT NULL,
  audit_id                        STRING,
  impact                          INT,
  rule_id                         INT,
  ruleset_id                      INT,
  common_text                     STRING,
  main_text                       STRING,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (row_key),
  FOREIGN KEY (result_key) REFERENCES r_order(result_key)
);

CREATE TABLE r_order_status (
  row_key                         BIGINT IDENTITY(1,1) NOT NULL,
  create_date                     DATE DEFAULT CURRENT_DATE() NOT NULL,
  create_date_time                TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP() NOT NULL,
  rule_id                         INT,
  comments                        STRING,
  review_status                   INT,
  update_date                     TIMESTAMP_NTZ,
  update_user                     STRING,
  result_key                      BIGINT NOT NULL,
  PRIMARY KEY (row_key),
  FOREIGN KEY (result_key) REFERENCES r_order(result_key)
);
